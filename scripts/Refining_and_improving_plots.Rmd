---
title: "refining_plots"
author: "Mahmudur Rahman"
date: "05/07/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
head(asasec)

df <- as_tibble(asasec)

p0 <- df %>% 
  filter(Year ==2014) %>% 
  ggplot(aes(Members,Revenues,label = Sname))+
  geom_point()

p1 <- p0+
  geom_point(aes(color = Journal))+
  geom_smooth(method = "lm",se = F,color = "grey")

# add some text label
txt_lbl <- df %>% 
  filter(Year == 2014 & Revenues > 7000)

p2 <- p1+
  geom_text_repel(data = txt_lbl)

#label the axes and scale,labs
p3 <- p2+
  labs(x="Membership",
        y="Revenues",
        color = "Section has own Journal",
        title = "ASA Sections",
        subtitle = "2014 Calendar year.",
        caption = "Source: ASA annual report.")


p3+
  scale_y_continuous(labels = dollar)+
  theme(legend.position = "bottom")
```
# Using color to plots
maping a variable to a color scale 
We choose color palettes for mappings through one of the scale_ functions for color or fill
RColorBrewer package is recomended 

cale_color_brewer() or
scale_fill_brewer()

dichromat pacage for safe color for  color blindness
Note:
You can also specify colors manually, via scale_color_manual() or scale_fill_manual().
```{r}
library(RColorBrewer)
library(ggthemes)
library(cowplot) #contains a well-developed theme suitable for figures
library(hrbrthemes)
library(cowplot)
library(ggridges)
```


```{r}

p <- ggplot(data = gss_lon,
            mapping = aes(x = age, y = factor(year, levels = rev(unique(year)),
                                     ordered = TRUE)))

p + geom_density_ridges(alpha = 0.6, fill = "lightblue", scale = 1.5) +
    scale_x_continuous(breaks = c(25, 50, 75)) +
    scale_y_discrete(expand = c(0.01, 0)) + 
    labs(x = "Age", y = NULL,
         title = "Age Distribution of\nGSS Respondents") +
    theme_ridges() +
    theme(title = element_text(size = 16, face = "bold"))

```

## time series plots 
Indexed series with a running difference below, using two separate plots.
```{r}

head(fredts)
fredts_m <- fredts %>% select(date, sp500_i, monbase_i) %>%
  pivot_longer(cols = sp500_i:monbase_i,
               names_to = "series",
               values_to = "score")

p <- fredts_m %>% 
  ggplot(aes(date,score ,group = series,color = series))
p1 <- p+
  geom_line()+
  theme(legend.position = "top")+
  labs(x="Date",
       y = "Index",
       color = "Series")

p <- fredts %>% 
  ggplot(aes(date,sp500_i-monbase_i))

p2 <- p+
  geom_line()
  
p2 <- p2+
  labs(x= "Date",
       y = "Difference")

# layout as required
cowplot::plot_grid(p1,p2,nrow = 2,rel_heights = c(0.75, 0.25), align = "v")


# layout engine in r called "grid"(gridExtra- helper pkg)
# cowplot- is more easier to layout plots

```
